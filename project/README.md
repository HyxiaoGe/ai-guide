# æ™ºèƒ½æ–‡æ¡£åŠ©æ‰‹ - MCP RAG ç³»ç»Ÿ

åŸºäº MCP (Model Context Protocol) åè®®çš„æ™ºèƒ½æ–‡æ¡£æ£€ç´¢å’Œé—®ç­”ç³»ç»Ÿï¼Œé›†æˆäº† RAGã€LangChainã€ChromaDB ç­‰ç°ä»£ AI æŠ€æœ¯æ ˆã€‚

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„æ™ºèƒ½æ–‡æ¡£ç®¡ç†å’Œé—®ç­”ç³»ç»Ÿï¼Œä½¿ç”¨ MCP åè®®å®ç°æ ‡å‡†åŒ–çš„ AI å·¥å…·è°ƒç”¨ï¼Œä¸ºæ–‡æ¡£æ£€ç´¢å’Œæ™ºèƒ½é—®ç­”æä¾›ç»Ÿä¸€çš„æ¥å£ã€‚

## ğŸ”§ æŠ€æœ¯æ ˆ

- **AI æ¡†æ¶**: LangChain, OpenAI GPT
- **å‘é‡æ•°æ®åº“**: ChromaDB
- **å…³ç³»æ•°æ®åº“**: PostgreSQL
- **åè®®**: MCP (Model Context Protocol)
- **åç«¯**: Python, FastAPI
- **éƒ¨ç½²**: Docker

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ“š å½“å‰åŠŸèƒ½

- **æ–‡æ¡£ç®¡ç†**: æ·»åŠ ã€æ‰¹é‡å¯¼å…¥ã€å…ƒæ•°æ®ç®¡ç†
- **æ™ºèƒ½æ£€ç´¢**: è¯­ä¹‰æœç´¢ã€å…³é”®è¯æœç´¢ã€æ··åˆæœç´¢
- **é—®ç­”ç³»ç»Ÿ**: åŸºäºä¸Šä¸‹æ–‡çš„é—®ç­”ã€å¤šè½®å¯¹è¯ã€æ–‡æ¡£æ‘˜è¦
- **MCP æœåŠ¡**: 9ä¸ªæ ¸å¿ƒå·¥å…·ã€å®æ—¶è¿æ¥ç›‘æ§

### ğŸ”§ æ ¸å¿ƒå·¥å…·

1. `add_document` - æ·»åŠ æ–‡æ¡£åˆ°çŸ¥è¯†åº“
2. `batch_add_documents` - æ‰¹é‡æ·»åŠ å¤šä¸ªæ–‡æ¡£
3. `search_documents` - åœ¨çŸ¥è¯†åº“ä¸­æœç´¢ç›¸å…³æ–‡æ¡£
4. `semantic_search` - é«˜çº§è¯­ä¹‰æœç´¢
5. `answer_question` - åŸºäºçŸ¥è¯†åº“å›ç­”é—®é¢˜
6. `multi_turn_chat` - å¤šè½®å¯¹è¯é—®ç­”
7. `summarize_documents` - ç”Ÿæˆæ–‡æ¡£æ‘˜è¦
8. `get_collection_stats` - è·å–çŸ¥è¯†åº“ç»Ÿè®¡ä¿¡æ¯
9. `clear_collection` - æ¸…ç©ºçŸ¥è¯†åº“

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

- Python 3.10+
- PostgreSQL (å¯ä½¿ç”¨ç°æœ‰å®¹å™¨)
- OpenAI API Key

### ğŸ”§ å®‰è£…æ­¥éª¤

1. **ç¯å¢ƒè®¾ç½®**
   ```bash
   cd project
   ./setup.sh
   ```

2. **é…ç½® API å¯†é’¥**
   ```bash
   nano .env  # è®¾ç½® OPENAI_API_KEY
   ```

3. **å¯åŠ¨æœåŠ¡**
   ```bash
   ./start.sh
   ```

4. **æµ‹è¯•ç¯å¢ƒ**
   ```bash
   python test.py
   ```

## ğŸ“Š é¡¹ç›®ç»“æ„

```
project/
â”œâ”€â”€ mcp_services/           # MCPæœåŠ¡
â”‚   â””â”€â”€ rag_service/        # RAGé—®ç­”æœåŠ¡
â”‚       â””â”€â”€ server.py       # æ ¸å¿ƒæœåŠ¡å™¨
â”œâ”€â”€ data/                   # æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ vector_db/          # å‘é‡æ•°æ®åº“
â”‚   â”œâ”€â”€ uploads/            # æ–‡ä»¶ä¸Šä¼ 
â”‚   â””â”€â”€ cache/              # ç¼“å­˜
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ docker-compose.yml      # Dockeré…ç½®
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ setup.sh               # ç¯å¢ƒè®¾ç½®è„šæœ¬
â”œâ”€â”€ start.sh               # å¯åŠ¨è„šæœ¬
â””â”€â”€ test.py                # ç¯å¢ƒæµ‹è¯•è„šæœ¬
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ•°æ®æµ

```
MCPå®¢æˆ·ç«¯ â†â†’ MCPæœåŠ¡å™¨ â†â†’ RAGå¼•æ“ â†â†’ æ•°æ®åº“
                                   â”œâ”€â”€ ChromaDB (å‘é‡)
                                   â””â”€â”€ PostgreSQL (å…³ç³»)
```

### æ ¸å¿ƒç»„ä»¶

- **MCP åè®®å±‚**: æ ‡å‡†åŒ–çš„ AI å·¥å…·è°ƒç”¨æ¥å£
- **RAG å¼•æ“**: æ£€ç´¢å¢å¼ºç”Ÿæˆç³»ç»Ÿ
- **å‘é‡å­˜å‚¨**: ChromaDB æœ¬åœ°å‘é‡æ•°æ®åº“
- **å…³ç³»æ•°æ®åº“**: PostgreSQL å­˜å‚¨ç»“æ„åŒ–æ•°æ®
- **AI æ¨¡å‹**: OpenAI GPT è¿›è¡Œæ–‡æœ¬ç”Ÿæˆå’Œç†è§£

## ğŸ› ï¸ ä½¿ç”¨ç¤ºä¾‹

### å¯åŠ¨æœåŠ¡å™¨

```bash
./start.sh
```

### å®¢æˆ·ç«¯è¿æ¥

```python
from mcp.client.session import ClientSession
from mcp.client.stdio import stdio_client, StdioServerParameters

# è¿æ¥åˆ°MCPæœåŠ¡å™¨
server_params = StdioServerParameters(
    command="python",
    args=["mcp_services/rag_service/server.py"]
)

async with stdio_client(server_params) as (read, write):
    async with ClientSession(read, write) as session:
        await session.initialize()
        tools = await session.list_tools()
        print(f"å¯ç”¨å·¥å…·: {len(tools.tools)}")
```

## ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—

ç³»ç»Ÿæä¾›å®æ—¶çš„è¿æ¥ç›‘æ§å’Œæ“ä½œæ—¥å¿—ï¼š

- ğŸ”Œ å®¢æˆ·ç«¯è¿æ¥/æ–­å¼€çŠ¶æ€
- ğŸ“‹ å·¥å…·è°ƒç”¨è®°å½•
- ğŸ“ èµ„æºè®¿é—®æ—¥å¿—
- âš ï¸ é”™è¯¯å’Œå¼‚å¸¸è¿½è¸ª

## ğŸ”® æœªæ¥è§„åˆ’

- ğŸ“ æ–‡ä»¶æœåŠ¡ (æ”¯æŒå¤šæ ¼å¼æ–‡æ¡£)
- ğŸŒ API ç½‘å…³ (ç»Ÿä¸€ REST æ¥å£)
- ğŸ–¥ï¸ Web å‰ç«¯ (ç”¨æˆ·ç•Œé¢)
- ğŸ³ å®¹å™¨åŒ–éƒ¨ç½²

## ğŸ“ å¼€å‘è¯´æ˜

### æ·»åŠ æ–°å·¥å…·

1. åœ¨ `server.py` ä¸­æ·»åŠ å·¥å…·å®šä¹‰
2. å®ç°å·¥å…·çš„ä¸šåŠ¡é€»è¾‘
3. æ·»åŠ ç›¸åº”çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—

### é…ç½®è¯´æ˜

- `.env`: ç¯å¢ƒå˜é‡ (APIå¯†é’¥ã€æ•°æ®åº“è¿æ¥)
- `docker-compose.yml`: å®¹å™¨é…ç½®
- `requirements.txt`: Python ä¾èµ–

## ğŸ“„ è®¸å¯è¯

MIT License